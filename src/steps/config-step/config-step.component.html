<div class="p-6 sm:p-8 space-y-6" [formGroup]="configForm()">
  @if (error()) {
    <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md animate-fade-in" role="alert">
      <p class="font-bold">Error</p>
      <p>{{ error() }}</p>
    </div>
  }
  <div class="space-y-2">
    <label for="tocUrl" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Table of Contents URL</label>
    <input id="tocUrl" type="url" formControlName="tocUrl" placeholder="https://your-novel-website.com/novel/table-of-contents" required class="w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 text-gray-800 dark:text-gray-50 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500">
  </div>

  <div class="space-y-2">
    <label for="firstChapterUrl" class="block text-sm font-medium text-gray-700 dark:text-gray-300">First Chapter URL (for testing)</label>
    <input id="firstChapterUrl" type="url" formControlName="firstChapterUrl" placeholder="URL of the first chapter page" class="w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 text-gray-800 dark:text-gray-50 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500">
    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Provide a link to the first chapter to test chapter-specific selectors like title, content, and next page link.</p>
  </div>
  
  <div class="space-y-4">
    <div class="relative">
      <div class="absolute inset-0 flex items-center" aria-hidden="true">
        <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
      </div>
      <div class="relative flex justify-center">
        <span class="bg-white dark:bg-gray-800 px-2 text-sm text-gray-500 dark:text-gray-400">Or start with an example</span>
      </div>
    </div>
    
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      @for (preset of defaultPresets(); track preset.name) {
        <button (click)="loadDefaultPreset.emit(preset.config)" class="text-left p-4 bg-gray-50 dark:bg-gray-700/50 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 border border-gray-200 dark:border-gray-700 rounded-lg transition-all duration-200 hover:shadow-md hover:border-indigo-300 dark:hover:border-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800">
          <p class="font-semibold text-indigo-700 dark:text-indigo-400">{{ preset.name }}</p>
          <p class="text-xs text-gray-500 dark:text-gray-400 truncate">{{ preset.config.tocUrl }}</p>
        </button>
      }
    </div>
  </div>

  <div class="my-4">
    <button (click)="autoDetectSelectors.emit()" [disabled]="!configForm().get('tocUrl')?.value || !configForm().get('firstChapterUrl')?.value || isDetecting() || configForm().get('dataSourceType')?.value === 'json'" class="w-full bg-green-600 hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center space-x-2 transition-colors">
      @if (isDetecting()) {
        <app-icon-spinner class="h-5 w-5 text-white"></app-icon-spinner>
        <span>Analyzing Pages...</span>
      } @else {
        <app-icon-wand class="h-5 w-5"></app-icon-wand>
        <span>Auto-Detect Selectors (Experimental)</span>
      }
    </button>
    @if (detectionStatus(); as status) {
      <div class="mt-4 p-3 rounded-md text-sm text-center animate-fade-in" 
           [class.bg-green-100]="status.type === 'success'" 
           [class.text-green-800]="status.type === 'success'" 
           [class.bg-red-100]="status.type === 'error'" 
           [class.text-red-800]="status.type === 'error'">
        {{ status.message }}
      </div>
    }
  </div>
</div>
<div class="p-6 bg-gray-50 dark:bg-slate-800 border-t border-gray-200 dark:border-gray-700">
  <button (click)="fetchDetails.emit()" [disabled]="isLoading()" class="w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center space-x-2 transition-colors">
    @if (isLoading()) {
      <app-icon-spinner class="h-5 w-5 text-white"></app-icon-spinner>
      <span>Fetching Chapters...</span>
    } @else {
      <span>Fetch Novel Chapters</span>
    }
  </button>
</div>
